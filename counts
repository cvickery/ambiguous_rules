#! /usr/local/bin/bash

# Show the different strings that appear in rules_report.txt. By default, ones that contain 'BKCR'.
# If the SUMMARY environment variable is set, arrange rules_report.txt into groups according to
# which combination of receiving courses are all, partially, or not BKCR.

# You can show any types of lines, but SUMMARY works only for BKCR.
key=$1
if [[ $key == '' ]]
then
  key=BKCR
fi

IFS=$'\n'
lines=`ack $key rules_report.txt|sort|uniq`

for line in $lines
do
  count=`ack -c "$line" rules_report.txt`
  echo -e "$count\t$line" >> $$_counts
done

for line in `cat $$_counts | sort -k1 -n`
do
  echo $line
  if [[ $SUMMARY ]]
  then
    echo -e "----------------------------------------------------------------------"
    text=`echo "$line" | cut -f 2-`
    examples=`ack -B 4 -A 1 "$text" rules_report.txt`
    echo "$examples"
    echo
  IFS=$'\n'
  fi
done
rm $$_counts
